use std/flow/void::StreamBlock
use std/filler/scalar/i32::StaticVecFill

/**
Emit a value as stream when trigger is received.

The vector is sent through the stream and the stream is closed immediately afterwards.

```mermaid
graph LR
    T("Emit(value=ï¼»ğŸŸ§ ğŸŸ§ ğŸŸ§ï¼½)")
    B["ã€ˆğŸŸ¦ã€‰"] -->|trigger| T
    
    T -->|value| O["ï¼»ğŸŸ§ ğŸŸ§ ğŸŸ§ï¼½"]

    style B fill:#ffff,stroke:#ffff
    style O fill:#ffff,stroke:#ffff
```
*/
sequence Emit(var value: Vec<i32> = [0])
  input trigger: Block<void>
  output value:  Stream<Vec<i32>>
{
    StreamBlock()
    StaticVecFill(value=value)

    Self.trigger -> StreamBlock.block,stream -> StaticVecFill.pattern,value -> Self.value
}


use std/flow/void::Linearize
use std/flow/i32::Organize
use std/filler/scalar/i32::StaticFill as ScalarStaticFill

/**
Fill an input `Vec<void>` stream with scalar static `i32` values.

```mermaid
graph LR
    T("StaticFillÂ (value=ğŸŸ§)")
    B["â€¦ï¼»ğŸŸ¦Â ğŸŸ¦Â ğŸŸ¦ï¼½ï¼»ğŸŸ¦Â ğŸŸ¦ï¼½ï¼»ğŸŸ¦Â ğŸŸ¦Â ğŸŸ¦ï¼½â€¦"] -->|pattern| T
    
    T -->|value| O["â€¦ï¼»ğŸŸ§Â ğŸŸ§Â ğŸŸ§ï¼½ï¼»ğŸŸ§Â ğŸŸ§ï¼½ï¼»ğŸŸ§Â ğŸŸ§Â ğŸŸ§ï¼½â€¦"]

    style B fill:#ffff,stroke:#ffff
    style O fill:#ffff,stroke:#ffff
```
*/
sequence StaticFill(var value: i32 = 0)
  input pattern: Stream<Vec<void>>
  output value:  Stream<Vec<i32>>
{
    Linearize()
    ScalarStaticFill(value=value)
    Organize()

    Self.pattern -> Linearize.vector,value -> ScalarStaticFill.pattern,value -> Organize.value,values -> Self.value
    Self.pattern -------------------------------------------------------------> Organize.pattern
    
}

